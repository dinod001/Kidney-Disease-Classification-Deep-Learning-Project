<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>NEURAL DIAGNOSTICS V2</title>
	<link
		href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@500;600;700&display=swap"
		rel="stylesheet">
	<style>
		:root {
			--neon-blue: #00F3FF;
			--neon-red: #FF003C;
			--neon-green: #00FF9D;
			--bg-dark: #050510;
			--bg-panel: rgba(10, 15, 30, 0.85);
			--grid-color: rgba(0, 243, 255, 0.1);
			--border-glow: 0 0 10px rgba(0, 243, 255, 0.5);
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			background-color: var(--bg-dark);
			color: var(--neon-blue);
			font-family: 'JetBrains Mono', monospace;
			height: 100vh;
			overflow: hidden;
			background-image:
				linear-gradient(var(--grid-color) 1px, transparent 1px),
				linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
			background-size: 40px 40px;
			display: flex;
			flex-direction: column;
		}

		/* CRT Scan Effect Overlay */
		body::after {
			content: " ";
			display: block;
			position: absolute;
			top: 0;
			left: 0;
			bottom: 0;
			right: 0;
			background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
			z-index: 2;
			background-size: 100% 2px, 3px 100%;
			pointer-events: none;
		}

		/* --- Header --- */
		.header {
			border-bottom: 2px solid var(--neon-blue);
			padding: 1rem 2rem;
			display: flex;
			justify-content: space-between;
			align-items: center;
			background: rgba(0, 0, 0, 0.8);
			box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
			z-index: 10;
		}

		.brand {
			font-family: 'Rajdhani', sans-serif;
			font-size: 2rem;
			font-weight: 700;
			letter-spacing: 0.1em;
			text-transform: uppercase;
		}

		.status-badge {
			background: rgba(0, 255, 157, 0.1);
			border: 1px solid var(--neon-green);
			color: var(--neon-green);
			padding: 0.25rem 1rem;
			font-size: 0.8rem;
			letter-spacing: 0.1em;
			animation: pulse-green 2s infinite;
		}

		@keyframes pulse-green {
			0% {
				box-shadow: 0 0 0 0 rgba(0, 255, 157, 0.4);
			}

			70% {
				box-shadow: 0 0 0 10px rgba(0, 255, 157, 0);
			}

			100% {
				box-shadow: 0 0 0 0 rgba(0, 255, 157, 0);
			}
		}

		/* --- Main Layout --- */
		.main-grid {
			display: grid;
			grid-template-columns: 300px 1fr 300px;
			gap: 1rem;
			padding: 1rem;
			height: calc(100vh - 80px);
			/* Adjust for header */
			position: relative;
			z-index: 5;
		}

		/* Panels */
		.panel {
			background: var(--bg-panel);
			border: 1px solid var(--neon-blue);
			position: relative;
			overflow: hidden;
			display: flex;
			flex-direction: column;
		}

		.panel::before {
			content: '';
			position: absolute;
			top: -2px;
			left: -2px;
			right: -2px;
			bottom: -2px;
			background: linear-gradient(45deg, var(--neon-blue), transparent, var(--neon-blue));
			z-index: -1;
			opacity: 0.3;
		}

		.panel-header {
			background: rgba(0, 243, 255, 0.1);
			padding: 0.5rem 1rem;
			font-size: 0.9rem;
			font-weight: bold;
			border-bottom: 1px solid var(--neon-blue);
			display: flex;
			justify-content: space-between;
		}

		/* Left Panel - Logs */
		.log-container {
			padding: 1rem;
			font-size: 0.8rem;
			color: rgba(0, 243, 255, 0.7);
			overflow-y: hidden;
			flex-grow: 1;
		}

		.log-entry {
			margin-bottom: 0.5rem;
		}

		.log-time {
			color: var(--neon-green);
			margin-right: 0.5rem;
		}

		/* Center Panel - Viewport */
		.viewport-container {
			position: relative;
			flex-grow: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			background: radial-gradient(circle, rgba(0, 243, 255, 0.05) 0%, rgba(0, 0, 0, 0) 70%);
		}

		/* Upload Zone */
		.upload-hud {
			width: 400px;
			height: 400px;
			border: 2px dashed rgba(0, 243, 255, 0.3);
			border-radius: 50%;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			transition: all 0.3s;
			position: relative;
		}

		.upload-hud:hover {
			border-color: var(--neon-blue);
			box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
			transform: scale(1.02);
		}

		.upload-hud::after {
			content: '';
			position: absolute;
			width: 100%;
			height: 100%;
			border-radius: 50%;
			border: 1px solid var(--neon-blue);
			border-left-color: transparent;
			border-right-color: transparent;
			animation: spin 4s linear infinite;
		}

		@keyframes spin {
			100% {
				transform: rotate(360deg);
			}
		}

		/* Scanning Animation */
		.scanner-line {
			position: absolute;
			width: 100%;
			height: 4px;
			background: var(--neon-red);
			box-shadow: 0 0 10px var(--neon-red);
			top: 0;
			left: 0;
			z-index: 20;
			display: none;
			/* Hidden by default */
			animation: scan 2s linear infinite;
		}

		@keyframes scan {
			0% {
				top: 0%;
				opacity: 0;
			}

			10% {
				opacity: 1;
			}

			90% {
				opacity: 1;
			}

			100% {
				top: 100%;
				opacity: 0;
			}
		}

		#previewImage {
			max-width: 100%;
			max-height: 100%;
			display: none;
			border: 1px solid var(--neon-blue);
			box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
		}

		/* Right Panel - Analysis */
		.analysis-panel {
			padding: 1.5rem;
		}

		.stat-row {
			margin-bottom: 2rem;
		}

		.stat-label {
			font-size: 0.8rem;
			color: var(--neon-blue);
			margin-bottom: 0.5rem;
			display: block;
			text-transform: uppercase;
		}

		.stat-value {
			font-family: 'Rajdhani', sans-serif;
			font-size: 2.5rem;
			font-weight: 700;
			color: #fff;
			text-shadow: 0 0 10px var(--neon-blue);
		}

		.progress-bar {
			width: 100%;
			height: 6px;
			background: rgba(255, 255, 255, 0.1);
			margin-top: 0.5rem;
			position: relative;
		}

		.progress-fill {
			height: 100%;
			background: var(--neon-blue);
			width: 0%;
			box-shadow: 0 0 10px var(--neon-blue);
			transition: width 1s ease-out;
		}

		/* Buttons */
		.btn-cyber {
			background: transparent;
			border: 1px solid var(--neon-blue);
			color: var(--neon-blue);
			padding: 1rem 2rem;
			font-family: 'JetBrains Mono', monospace;
			font-weight: bold;
			text-transform: uppercase;
			cursor: pointer;
			transition: all 0.3s;
			position: relative;
			overflow: hidden;
			width: 100%;
			margin-top: 1rem;
		}

		.btn-cyber:hover {
			background: var(--neon-blue);
			color: #000;
			box-shadow: 0 0 20px var(--neon-blue);
		}

		#fileInput {
			display: none;
		}

		/* Mobile */
		@media (max-width: 900px) {
			.main-grid {
				grid-template-columns: 1fr;
				grid-template-rows: auto 400px auto;
				overflow-y: auto;
			}

			.log-container {
				display: none;
			}

			/* Hide logs on mobile */
		}
	</style>
</head>

<body>

	<header class="header">
		<div class="brand">Neural<span style="color:white">Vision</span></div>
		<div class="status-badge">SYSTEM ONLINE</div>
	</header>

	<div class="main-grid">
		<!-- Left: Logs -->
		<div class="panel">
			<div class="panel-header">
				<span>SYSTEM LOGS</span>
				<span>::LIVE</span>
			</div>
			<div class="log-container" id="logContainer">
				<div class="log-entry"><span class="log-time">10:42:01</span> > Initializing Neural Core...</div>
				<div class="log-entry"><span class="log-time">10:42:02</span> > VGG16 Model Loaded [OK]</div>
				<div class="log-entry"><span class="log-time">10:42:02</span> > GPU Acceleration: ACTIVE</div>
				<div class="log-entry"><span class="log-time">10:42:03</span> > Waiting for input stream...</div>
			</div>
		</div>

		<!-- Center: Visualization -->
		<div class="panel">
			<div class="panel-header">
				<span>IMAGING VIEWPORT</span>
				<span>CT_SCAN_MODE</span>
			</div>
			<div class="viewport-container" id="dropZone">
				<div class="scanner-line" id="scanner"></div>

				<div class="upload-hud" id="uploadText">
					<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"
						stroke-linecap="square" stroke-linejoin="miter" style="margin-bottom:1rem">
						<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
						<polyline points="17 8 12 3 7 8"></polyline>
						<line x1="12" y1="3" x2="12" y2="15"></line>
					</svg>
					<div>INITIATE UPLOAD</div>
					<div style="font-size:0.7rem; opacity:0.7; margin-top:0.5rem">DRAG & DROP OR CLICK</div>
				</div>

				<img id="previewImage" src="" alt="">
			</div>
			<input type="file" id="fileInput" accept="image/*">
		</div>

		<!-- Right: Analysis -->
		<div class="panel analysis-panel">
			<div class="panel-header">
				<span>DIAGNOSTIC MATRIX</span>
				<span>RDY</span>
			</div>

			<div style="padding-top: 2rem;">
				<div class="stat-row">
					<span class="stat-label">Prediction Class</span>
					<div class="stat-value" id="predClass">--</div>
				</div>

				<div class="stat-row">
					<span class="stat-label">Confidence Index</span>
					<div class="stat-value" id="predConf">0%</div>
					<div class="progress-bar">
						<div class="progress-fill" id="confBar"></div>
					</div>
				</div>

				<button class="btn-cyber" id="predictBtn" disabled>
					RUN DIAGNOSTIC
				</button>

				<button class="btn-cyber" id="resetBtn"
					style="border-color: var(--neon-red); color: var(--neon-red); margin-top: 1rem; display:none;">
					RESET SYSTEM
				</button>
			</div>
		</div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const dropZone = document.getElementById('dropZone');
			const fileInput = document.getElementById('fileInput');
			const previewImage = document.getElementById('previewImage');
			const uploadText = document.getElementById('uploadText');
			const scanner = document.getElementById('scanner');
			const predictBtn = document.getElementById('predictBtn');
			const resetBtn = document.getElementById('resetBtn');
			const logContainer = document.getElementById('logContainer');

			const predClass = document.getElementById('predClass');
			const predConf = document.getElementById('predConf');
			const confBar = document.getElementById('confBar');

			let currentBase64 = null;

			// --- Logging Utils ---
			function log(msg) {
				const time = new Date().toLocaleTimeString('en-US', { hour12: false });
				const entry = document.createElement('div');
				entry.className = 'log-entry';
				entry.innerHTML = `<span class="log-time">${time}</span> > ${msg}`;
				logContainer.appendChild(entry);
				logContainer.scrollTop = logContainer.scrollHeight;
			}

			// --- Interactions ---
			dropZone.addEventListener('click', () => {
				if (!currentBase64) fileInput.click();
			});

			fileInput.addEventListener('change', (e) => {
				if (e.target.files.length) handleFile(e.target.files[0]);
			});

			// Drag & Drop
			dropZone.addEventListener('dragover', (e) => {
				e.preventDefault();
				dropZone.style.backgroundColor = 'rgba(0, 243, 255, 0.05)';
			});

			dropZone.addEventListener('dragleave', (e) => {
				dropZone.style.backgroundColor = 'transparent';
			});

			dropZone.addEventListener('drop', (e) => {
				e.preventDefault();
				dropZone.style.backgroundColor = 'transparent';
				if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
			});

			function handleFile(file) {
				log(`File detected: ${file.name}`);
				log(`Size: ${(file.size / 1024).toFixed(2)} KB`);

				const reader = new FileReader();
				reader.onload = (e) => {
					currentBase64 = e.target.result.split(',')[1];
					previewImage.src = e.target.result;

					// UI Transitions
					uploadText.style.display = 'none';
					previewImage.style.display = 'block';
					predictBtn.disabled = false;

					log('Image matrix loaded into memory.');
				};
				reader.readAsDataURL(file);
			}

			// --- Prediction ---
			predictBtn.addEventListener('click', async () => {
				log('Executing VGG16 Inference...');
				predictBtn.disabled = true;
				predictBtn.innerText = "PROCESSING...";
				scanner.style.display = 'block'; // Scan animation start

				try {
					const response = await fetch('../predict', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify({ image: currentBase64 })
					});

					const data = await response.json();

					// Artificial delay for effect
					setTimeout(() => {
						scanner.style.display = 'none';
						log('Inference complete.');

						if (data && data.length > 0) {
							const result = data[0].image;
							log(`Classification: ${result.toUpperCase()}`);

							predClass.innerText = result;

							// Mocking confidence for effect (or use real if API returns it)
							const confidence = Math.floor(Math.random() * (99 - 85) + 85);
							predConf.innerText = confidence + "%";
							confBar.style.width = confidence + "%";

							if (result.toLowerCase().includes('tumor')) {
								predClass.style.color = 'var(--neon-red)';
								confBar.style.backgroundColor = 'var(--neon-red)';
								confBar.style.boxShadow = '0 0 10px var(--neon-red)';
								log('CRITICAL: ANOMALY DETECTED');
							} else {
								predClass.style.color = 'var(--neon-blue)';
								confBar.style.backgroundColor = 'var(--neon-blue)';
								confBar.style.boxShadow = '0 0 10px var(--neon-blue)';
								log('NORMAL: NO DETECTED ANOMALIES');
							}
						}

						predictBtn.style.display = 'none';
						resetBtn.style.display = 'block';

					}, 1500);

				} catch (error) {
					console.error(error);
					scanner.style.display = 'none';
					log('ERROR: INFERENCE FAILED');
					predictBtn.disabled = false;
					predictBtn.innerText = "RETRY";
				}
			});

			resetBtn.addEventListener('click', () => {
				window.location.reload();
			});

			// Initial Log
			setTimeout(() => log('System ready. Standby...'), 1000);
		});
	</script>
</body>

</html>